#!/bin/python3
# Download the helper library from https://www.twilio.com/docs/python/install
#these imports for for twilio
import os
from twilio.rest import Client
account_sid = os.environ['TWILIO_ACCOUNT_SID']
auth_token = os.environ['TWILIO_AUTH_TOKEN']
client = Client(account_sid, auth_token)

#these imports are for scheduler
from datetime import datetime
now = datetime.now()

#this is to make the wait time work for our loop
from time import sleep

#this is for the scheduling of our app
# Schedule Library imported
import schedule
import time
 

# while True:
#         print("test")
#         sleep(10)
#         #api call goes here
#         if (True):
#                 message = client.messages \
#                 .create(
#                         body='This is the ship that made the Kessel Run in fourteen parsecs?',
#                         #hidden for privacy
#                         from_='+1',
#                         to='+1'
#                 )

#                 print(message.sid)

#this is how we send our call to the user
# call = client.calls.create(
#         #this is hosted by twilio assets static hosting. 
#         url='https://telemagenta-goldfish-8538.twil.io/assets/quickEscape.mp3',
#         to='+1',
#         from_='+1'
#         )

# print(call.sid)
 
def pickMeUp():
        call = client.calls.create(
                #this is hosted by twilio assets static hosting. 
                url='https://telemagenta-goldfish-8538.twil.io/assets/quickEscape.mp3',
                to='+12024597238',
                from_='+18339023143'
                )
        message = client.messages \
        .create(
                body='My car broke down and I dont have roadside, you gotta come get me',
                #hidden for privacy
                from_='+18339023143',
                to='+12024597238'
        )
        print(message.sid)


# Functions setup
def message():
    print("Hoohacks 2023")
 
# Task scheduling
# After every 10mins geeks() is called.
schedule.every(.1).minutes.do(pickMeUp)

# Loop so that the scheduling task
# keeps on running all time.
while True:
 
    # Checks whether a scheduled task
    # is pending to run or not
    schedule.run_pending()
    time.sleep(1)

